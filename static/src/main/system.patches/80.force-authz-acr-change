diff -aurN shibboleth-idp/system/flows/authn/authn-beans.xml.orig shibboleth-idp/system/flows/authn/authn-beans.xml
--- shibboleth-idp/system/flows/authn/authn-beans.xml.orig    2020-06-02 15:56:00.000000000 +0000
+++ shibboleth-idp/system/flows/authn/authn-beans.xml 2021-09-10 11:45:08.410184464 +0000
@@ -50,6 +50,9 @@

     <bean id="FilterFlowsByForcedAuthn"
         class="net.shibboleth.idp.authn.impl.FilterFlowsByForcedAuthn" scope="prototype" />
+
+    <bean id="FilterFlowsByAcrChangedAuthn"
+        class="org.gluu.idp.externalauth.FilterFlowsByAcrChangedAuthn" scope="prototype" />

     <bean id="FilterFlowsByNonBrowserSupport"
         class="net.shibboleth.idp.authn.impl.FilterFlowsByNonBrowserSupport" scope="prototype" />
diff -aurN shibboleth-idp/system/flows/authn/authn-flow.xml.orig shibboleth-idp/system/flows/authn/authn-flow.xml
--- shibboleth-idp/system/flows/authn/authn-flow.xml.orig     2020-06-02 15:56:00.000000000 +0000
+++ shibboleth-idp/system/flows/authn/authn-flow.xml  2021-09-09 19:15:39.974233323 +0000
@@ -36,6 +36,7 @@
     <action-state id="FilterFlows">
         <evaluate expression="InitializeRequestedPrincipalContext" />
         <evaluate expression="FilterFlowsByForcedAuthn" />
+        <evaluate expression="FilterFlowsByAcrChangedAuthn" />
         <evaluate expression="FilterFlowsByNonBrowserSupport" />
         <evaluate expression="'proceed'" />

